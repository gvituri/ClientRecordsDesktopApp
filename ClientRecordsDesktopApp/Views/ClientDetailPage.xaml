<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ClientRecordsDesktopApp.Views.ClientDetailPage"
             xmlns:vm="clr-namespace:ClientRecordsDesktopApp.ViewModels"
             x:DataType="vm:ClientDetailViewModel"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:validation="clr-namespace:InputKit.Shared.Validations;assembly=InputKit.Maui"
             xmlns:customValidation="clr-namespace:ClientRecordsDesktopApp.Utils.Validations"
             xmlns:icons="clr-namespace:UraniumUI.Icons.MaterialSymbols;assembly=UraniumUI.Icons.MaterialSymbols"
             xmlns:input="clr-namespace:InputKit.Shared.Controls;assembly=InputKit.Maui"
             Title="ClientDetailPage">
    <ScrollView>
        <input:FormView SubmitCommand="{Binding SaveCommand}"
                        Spacing="20">
            <StackLayout Spacing="25"
                         WidthRequest="500">

                <Label Style="{StaticResource Headline}">
                    <Label.Triggers>
                        <DataTrigger TargetType="Label"
                                     Binding="{Binding IsEditMode}"
                                     Value="True">
                            <Setter Property="Text"
                                    Value="Detalhes do Cliente" />
                        </DataTrigger>
                        <DataTrigger TargetType="Label"
                                     Binding="{Binding IsEditMode}"
                                     Value="False">
                            <Setter Property="Text"
                                    Value="Registrar Cliente" />
                        </DataTrigger>
                    </Label.Triggers>
                </Label>

                <Label Style="{StaticResource Paragraph}">
                    <Label.Triggers>
                        <DataTrigger TargetType="Label"
                                     Binding="{Binding IsEditMode}"
                                     Value="True">
                            <Setter Property="Text"
                                    Value="Altere o formulário e salve para atualizar os detalhes do cliente." />
                        </DataTrigger>
                        <DataTrigger TargetType="Label"
                                     Binding="{Binding IsEditMode}"
                                     Value="False">
                            <Setter Property="Text"
                                    Value="Preencha as informações abaixo para registrar um novo cliente." />
                        </DataTrigger>
                    </Label.Triggers>
                </Label>

                <Grid ColumnDefinitions="*,*"
                      ColumnSpacing="25">

                    <material:TextField Title="Nome"
                                        Text="{Binding Client.Name}"
                                        Grid.Column="0">
                        <validation:RequiredValidation Message="Este campo é obrigatório." />
                        <customValidation:SqlFriendlyStringValidation />
                    </material:TextField>

                    <material:TextField Title="Sobrenome"
                                        Text="{Binding Client.LastName}"
                                        Grid.Column="1">
                        <validation:RequiredValidation Message="Este campo é obrigatório." />
                        <customValidation:SqlFriendlyStringValidation />
                    </material:TextField>
                </Grid>

                <material:TextField Text="{Binding Client.Age}"
                                    Title="Idade">
                    <validation:RequiredValidation Message="Este campo é obrigatório." />
                    <customValidation:AgeValidation />
                </material:TextField>

                <material:TextField Title="Endereço"
                                    Text="{Binding Client.Adress}">
                    <validation:RequiredValidation Message="Este campo é obrigatório." />
                    <customValidation:SqlFriendlyStringValidation />
                </material:TextField>

                <Grid ColumnDefinitions="*,*"
                      ColumnSpacing="25">

                    <Button Text="Excluir"
                            StyleClass="FilledButton"
                            Style="{StaticResource DangerButton}"
                            Command="{Binding DeleteCommand}"
                            IsVisible="{Binding IsEditMode}"
                            Grid.Column="0">
                        <Button.ImageSource>
                            <FontImageSource FontFamily="MaterialSharp"
                                             Size="20"
                                             Glyph="{x:Static icons:MaterialSharp.Delete}"
                                             Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}" />
                        </Button.ImageSource>
                    </Button>

                    <Button Text="Salvar"
                            input:FormView.IsSubmitButton="True"
                            StyleClass="FilledButton"
                            Style="{StaticResource ConfirmButton}"
                            Grid.Column="1">
                        <Button.ImageSource>
                            <FontImageSource FontFamily="MaterialSharp"
                                             Size="20"
                                             Glyph="{x:Static icons:MaterialSharp.Save}"
                                             Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}" />
                        </Button.ImageSource>
                    </Button>
                </Grid>
            </StackLayout>
        </input:FormView>
    </ScrollView>
</ContentPage>